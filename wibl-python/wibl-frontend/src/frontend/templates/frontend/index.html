{% extends "base_nav.html" %}

{% load static %}

{% block content %}
    <script src="{% static 'frontend/js/SocketManager.js' %}"></script>
    <script src="{% static 'frontend/js/WIBLFileList.js' %}"></script>
    <script type="module" src="{% static 'frontend/js/WIBLFileTable.js' %}"></script>

    <section class="container">
      <div class="columns">
        <div class="column is-three-quarters">
          <span class="is-size-4 has-text-weight-semibold">WIBL files</span>
          <wibl-file-table id="wibl-file-table"
                           url="{{ wsURL }}"
                           stylesheet="{% static 'css/bulma-no-dark-mode.min.css' %}">
          </wibl-file-table>
        </div>

        <div class="column is-one-quarter">
          WIBL files...
          <ul id="wibl-file-list">

          </ul>
          <wibl-file-list id="wibl-file-list1"
                          url="{{ wsURL }}"
                          stylesheet="{% static 'frontend/css/WIBLFileList.css' %}">
          </wibl-file-list>

          <button id="exampleButton1" class="button">Click me!</button>
        </div>
      </div>
    </section>

    <script>
        // Request WIBL file data from the WebSocket once the DOM is ready; do this here instead of in the
        // components to that the request is only sent once.
        setTimeout(() => {
            const wiblSockType = "wibl";
            const wiblSockUrl = "{{ wsURL }}" + wiblSockType + "/";
            const wiblSock = SocketManager.getInstance(wiblSockUrl, wiblSockType);
            wiblSock.sendRequest("list-wibl-files");
        });
    </script>

    <script>
        // Example showing how to call a member function of `wibl-file-list` web component
        // to show come level of reactivity.
        const button = document.getElementById("exampleButton1");
        button.addEventListener("click", (event) => {
            var wiblFileList = document.getElementById("wibl-file-list1");
            wiblFileList.exampleOutsideEventReactivity();
        })
    </script>
{% endblock %}
